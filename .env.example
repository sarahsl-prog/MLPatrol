# MLPatrol Environment Variables

# ============================================================================
# LLM Configuration
# ============================================================================

# Option 1: Cloud LLMs (requires API key)
OPENAI_API_KEY=your_openai_api_key_here
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# Option 2: Local LLMs (no API key required, fully private)
USE_LOCAL_LLM=false  # Set to 'true' to use local LLM instead of cloud

# Local LLM Settings (only used if USE_LOCAL_LLM=true)
# Recommended models:
#   - ollama/llama3.1:8b (fast, general use - 8GB RAM)
#   - ollama/llama3.1:70b (high accuracy - 48GB RAM)
#   - ollama/mistral-small:3.1 (balanced - 16GB RAM)
#   - ollama/qwen2.5:14b (code analysis - 12GB RAM)
LOCAL_LLM_MODEL=ollama/llama3.1:8b
LOCAL_LLM_URL=http://localhost:11434

# Optional: HuggingFace
HUGGINGFACE_API_KEY=your_hf_api_key_here

# ============================================================================
# Script Reviewer LLM Configuration (Phase 2)
# ============================================================================

# Separate LLM for reviewing generated security scripts
# Can use different model than main agent for specialized review tasks

# Option 1: Use same LLM as main agent
USE_SEPARATE_REVIEWER_LLM=false  # Set to 'true' to use different model for reviews

# Option 2: Dedicated reviewer LLM (only used if USE_SEPARATE_REVIEWER_LLM=true)
REVIEWER_LLM_PROVIDER=anthropic  # Options: anthropic, openai, local
REVIEWER_LLM_MODEL=claude-sonnet-4-0  # Claude Sonnet 4 for deterministic reviews
REVIEWER_ANTHROPIC_API_KEY=your_anthropic_api_key_here
REVIEWER_OPENAI_API_KEY=your_openai_api_key_here

# For local reviewer LLM
REVIEWER_LOCAL_LLM_MODEL=ollama/llama3.1:70b  # Use larger model for better accuracy
REVIEWER_LOCAL_LLM_URL=http://localhost:11434

# ============================================================================
# Web Search Configuration
# ============================================================================

# Enable/disable web search functionality
ENABLE_WEB_SEARCH=true  # Set to 'false' to disable web search entirely

# Web Search Providers (can enable one or both)
# Set to 'true' to enable each provider, 'false' to disable
USE_TAVILY_SEARCH=true   # AI-native search, best for general security Q&A
USE_BRAVE_SEARCH=true    # Privacy-focused, best for CVE monitoring & breaking news

# Tavily AI Settings (only used if USE_TAVILY_SEARCH=true)
# Get your API key from: https://tavily.com
TAVILY_API_KEY=your_tavily_api_key_here
TAVILY_SEARCH_DEPTH=advanced  # Options: basic, advanced
TAVILY_MAX_RESULTS=5

# Brave Search API Settings (only used if USE_BRAVE_SEARCH=true)
# Get your API key from: https://brave.com/search/api/
BRAVE_API_KEY=your_brave_api_key_here
BRAVE_SEARCH_FRESHNESS=pw  # Options: pd (past day), pw (past week), pm (past month), py (past year)
BRAVE_MAX_RESULTS=5

# Search Routing Strategy
# When both providers are enabled, route queries based on type
# CVE monitoring queries → Brave (breaking news, real-time updates)
# General security Q&A → Tavily (AI-optimized summaries)
WEB_SEARCH_ROUTE_CVE_TO=brave    # Options: brave, tavily
WEB_SEARCH_ROUTE_GENERAL_TO=tavily  # Options: brave, tavily

# ============================================================================
# CVE Database Configuration
# ============================================================================

# National Vulnerability Database (NVD) API Key
# Get your API key from: https://nvd.nist.gov/developers/request-an-api-key
# Note: Requests without an API key are limited to 5 requests per 30 seconds
NVD_API_KEY=your_nvd_api_key_here

# ============================================================================
# Application Settings
# ============================================================================

LOG_LEVEL=INFO
MAX_AGENT_ITERATIONS=10
